@model TourScheduleHotelViewModel
<link href="~/Plugins/EasyAutocomplete-1.3.5/easy-autocomplete.min.css" rel="stylesheet" />
<link href="~/Plugins/EasyAutocomplete-1.3.5/easy-autocomplete.themes.min.css" rel="stylesheet" />
<script src="~/Plugins/EasyAutocomplete-1.3.5/jquery.easy-autocomplete.min.js"></script>
<style>
    #HotelTitle {
        min-width:350px !important;
    }
    .autoCompleteHotelTitle div
    {
        width:350px;
    }
</style>
@using (Ajax.BeginForm(Model.CRUDMode == CRUDMode.Create ? "Create" : "Edit", "TourScheduleHotel", null, new AjaxOptions()
{
    OnComplete = "",
    InsertionMode = Model.CRUDMode == CRUDMode.Create ? InsertionMode.InsertBefore : InsertionMode.Replace,
    UpdateTargetId = Model.CRUDMode == CRUDMode.Create ? "ListViewTourScheduleHotel" : Model.SectionId,
    HttpMethod = "POST",
    OnSuccess = "LoadPartialForTourScheduleHotel(" + Model.TourScheduleId + "," + Model.TourId + ")"
}, new { id = "frmTourScheduleHotel" }))
{
    @Html.AntiForgeryToken()
    @Html.HiddenFor(model => model.TourScheduleId)
    @Html.HiddenFor(model => model.HotelId)
    @Html.HiddenFor(model => model.TourId)


    <div class="well">
        <div class="form-horizontal">

            <div class="form-group nomargin">
                <div class="col-md-1">
                    <button type="submit" class="btn btn-primary">
                        <i class="@(Model.CRUDMode== CRUDMode.Create ? "fa fa-plus" : "fa fa-edit ")"></i>@(Model.CRUDMode == CRUDMode.Create ? ParvazPardaz.Resource.General.Generals.Add : ParvazPardaz.Resource.General.Generals.Update)
                    </button>
                </div>
            </div>


            <div class="row nomargin">
                <div class="col-md-11">
                    <div class="form-group">
                        <div class="editor-label text-right col-md-1">
                            @Html.LabelFor(model => model.HotelTitle, new { @class = "control-label" })
                        </div>
                        <div class="editor-field col-md-9 autoCompleteHotelTitle">
                            @Html.TextBoxFor(model => model.HotelTitle, new { @class = "form-control" })
                            @Html.ValidationMessageFor(model => model.HotelTitle, "", new { @class = "text-danger" })
                        </div>
                    </div>
                </div>
            </div>


        </div>
    </div>


}

<script type="text/javascript">
    $(document).ready(function () {
        $("#frmTourScheduleHotel").removeData("validator");
        $("#frmTourScheduleHotel").removeData("unobtrusiveValidation");
        $.validator.unobtrusive.parse("#frmTourScheduleHotel");

        var options = {
            
            url: function (phrase) {
                return "/admin/hotel/GetHotelsByTourProgram/";
            },

            getValue: function (element) {
                return element.HotelTitle;
            },

            template: {
                type: "description",
                fields: {
                    description: "Description"
                }
            },

            ajaxSettings: {
                dataType: "json",
                method: "Get",
                data: {
                    dataType: "json"
                }
            },

            list: {
                onSelectItemEvent: function () {
                    var selectedItemValue = $("#HotelTitle").getSelectedItemData().Id;
                    $("#HotelId").val(selectedItemValue).trigger("change");
                },
                //onHideListEvent: function () {
                //    $("#HotelId").val("").trigger("change");
                //}
            },

            preparePostData: function (data) {
                data.phrase = $("#HotelTitle").val();
                data.tourId = $("#TourId").val();
                return data;
            },

            requestDelay: 400,
            theme: "square"
        };
        $("#HotelTitle").easyAutocomplete(options);

    });

</script>
