@model ParvazPardaz.ViewModel.AddCityViewModel
@{
    ViewBag.Title = "Create";
}

@using (Html.BeginForm("Create", "City", FormMethod.Post, new { enctype = "multipart/form-data" }))
{
    @Html.AntiForgeryToken()

    <div class="form-horizontal">
        <h3>@ParvazPardaz.Resource.Tour.Tours.CityManagement</h3>
        <hr />
        @Html.Alert(AlertHelper.AlertType.Danger, Html.ValidationSummary().ToHtmlString(), ViewData.ModelState.IsValid)
        <div class="form-group">
            @Html.LabelFor(model => model.Title, new { @class = "control-label col-md-1" })
            <div class="col-md-3">
                @Html.TextBoxFor(model => model.Title, new { @class = "form-control" })
                @Html.ValidationMessageFor(model => model.Title, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.ENTitle, new { @class = "control-label col-md-1" })
            <div class="col-md-3">
                @Html.TextBoxFor(model => model.ENTitle, new { @class = "form-control" })
                @Html.ValidationMessageFor(model => model.ENTitle, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.CountryId, new { @class = "control-label col-md-1" })
            <div class="col-md-3">
                @Html.DropDownListFor(d => d.CountryId, Model.CountryList, ParvazPardaz.Resource.General.Generals.DDLSelect, new { id = "DDCountry", @class = "form-control search-select select" }) <!-- , onchange = "FetchState()" -->
                @Html.ValidationMessageFor(model => model.CountryId, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.StateId, new { @class = "control-label col-md-1" })
            <div class="col-md-3">
                @Html.DropDownListFor(d => d.StateId, Model.StateList, ParvazPardaz.Resource.General.Generals.DDLSelect, new { @class = "form-control search-select select", id = "DDState" })
                @Html.ValidationMessageFor(model => model.StateId, "", new { @class = "text-danger" })
            </div>
        </div>
        <div class="form-group">
            @Html.LabelFor(model => model.IsDddlFrom, new { @class = "control-label col-md-1" })
            <div class="col-md-3">
                @Html.CheckBoxFor(model => model.IsDddlFrom, new {@class = "form-control" })
                @Html.ValidationMessageFor(model => model.IsDddlFrom, "", new { @class = "text-danger" })
            </div>
        </div>
        <div class="form-group">
            @Html.LabelFor(model => model.IsDddlDestination, new { @class = "control-label col-md-1" })
            <div class="col-md-3">
                @Html.CheckBoxFor(model => model.IsDddlDestination, new { @class = "form-control" })
                @Html.ValidationMessageFor(model => model.IsDddlDestination, "", new { @class = "text-danger" })
            </div>
        </div>
        <div class="form-group">
            @Html.LabelFor(model => model.File, new { @class = "control-label col-md-1" })
            <div class="col-md-10">
                @Html.FileUploaderFor(model => model.File).AddMore(false).IsMultiple(false).ItemAppendToEnd(false).RemoveConfirmation(true).ShowThumbs(true).RemoveButton(true).RemoveButtonInEditMode(false)
                <div class="alert alert-info">
                    <i class="fa fa-info-circle"></i>
                    <strong>توجه!</strong> @ParvazPardaz.Resource.Tour.Tours.PicSize200x200
                </div>
                @Html.ValidationMessageFor(model => model.File, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            <div class="col-md-offset-1 col-md-11">
                <input type="submit" value=@ParvazPardaz.Resource.General.Generals.Create class="btn btn-custom green" />
                @Html.ActionLink(ParvazPardaz.Resource.General.Generals.Back, "Index", null, new { @class = "btn btn-custom red" })
            </div>
        </div>
    </div>

}

@section scripts{
    <script type="text/javascript">
        $('.select').select2();
    </script>

    <script>

        $("#DDCountry").change(function FetchState() {
            debugger;
            var items = "";
            var countryId = $("#DDCountry").val();
            if (countryId == "") {
                items = "<option value=\"" + 0 + "\">" + '@ParvazPardaz.Resource.General.Generals.DDLSelect' + "</option>";
                $("#DDState").html(items);
            }
            else {
                items = "<option value=\"" + 0 + "\">" + '@ParvazPardaz.Resource.General.Generals.DDLSelect' + "</option>";
                var x = $.getJSON("/Admin/City/FindStatesByCountryId/" + countryId, function (data) {
                    $.each(data, function (i, item) {
                        items += "<option value=\"" + item.Value + "\" " + ((item.Selected == true) ? "Selected" : "") + " >" + item.Text + "</option>";
                    });
                    $("#DDState").html(items);
                });
            }
        });

    </script>
}